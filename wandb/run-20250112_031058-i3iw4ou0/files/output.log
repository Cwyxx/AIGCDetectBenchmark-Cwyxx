Loading 162000 real images and 161997 fake images
Epoch 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2532/2532 [08:02<00:00,  5.25it/s]
Train loss: 0.4021745026111603 at step: 400
Train loss: 0.3005223274230957 at step: 800
Train loss: 0.3254293203353882 at step: 1200
Train loss: 0.18694233894348145 at step: 1600
Train loss: 0.26856714487075806 at step: 2000
saving the latest model GramNet-genimage-sdv1.4 (epoch 0, model.total_steps 2000)
Train loss: 0.23597408831119537 at step: 2400
saving the model at the end of epoch 0, iters 2532
Loading 6000 real images and 6000 fake images
(Val @ epoch 0) acc: 0.88675; ap: 0.9625759891987341, r_acc: 0.15766666666666668, f_acc: 0.9311666666666667
Validation accuracy increased (-inf --> 0.886750).  Saving model ...
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2532/2532 [08:02<00:00,  5.25it/s]
Train loss: 0.28005221486091614 at step: 2800
Train loss: 0.18849682807922363 at step: 3200
Train loss: 0.44494912028312683 at step: 3600
Train loss: 0.18172167241573334 at step: 4000
saving the latest model GramNet-genimage-sdv1.4 (epoch 1, model.total_steps 4000)
Train loss: 0.2397274672985077 at step: 4400
Train loss: 0.15091091394424438 at step: 4800
Loading 6000 real images and 6000 fake images
(Val @ epoch 1) acc: 0.924; ap: 0.9822220255036795, r_acc: 0.11533333333333333, f_acc: 0.9633333333333334
Validation accuracy increased (0.886750 --> 0.924000).  Saving model ...
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2532/2532 [08:04<00:00,  5.23it/s]
Train loss: 0.21494479477405548 at step: 5200
Train loss: 0.24749480187892914 at step: 5600
Train loss: 0.1784399449825287 at step: 6000
saving the latest model GramNet-genimage-sdv1.4 (epoch 2, model.total_steps 6000)
Train loss: 0.20170043408870697 at step: 6400
Train loss: 0.12712596356868744 at step: 6800
Train loss: 0.25613996386528015 at step: 7200
Loading 6000 real images and 6000 fake images
(Val @ epoch 2) acc: 0.78125; ap: 0.969085468227102, r_acc: 0.42916666666666664, f_acc: 0.9916666666666667
EarlyStopping counter: 1 out of 5
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2532/2532 [08:08<00:00,  5.18it/s]
Train loss: 0.17252613604068756 at step: 7600
Train loss: 0.13215869665145874 at step: 8000
saving the latest model GramNet-genimage-sdv1.4 (epoch 3, model.total_steps 8000)
Train loss: 0.1541006863117218 at step: 8400
Train loss: 0.10345955193042755 at step: 8800
Train loss: 0.17045584321022034 at step: 9200
Train loss: 0.1571095734834671 at step: 9600
Train loss: 0.08054041862487793 at step: 10000
saving the latest model GramNet-genimage-sdv1.4 (epoch 3, model.total_steps 10000)
Loading 6000 real images and 6000 fake images
(Val @ epoch 3) acc: 0.9305833333333333; ap: 0.9866401422705537, r_acc: 0.111, f_acc: 0.9721666666666666
Validation accuracy increased (0.924000 --> 0.930583).  Saving model ...
Epoch 4:  50%|████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                              | 1256/2532 [04:02<04:05,  5.19it/s]
Train loss: 0.2141832709312439 at step: 10400
Train loss: 0.1349216252565384 at step: 10800
Train loss: 0.19657503068447113 at step: 11200
Traceback (most recent call last):
  File "/data3/chenweiyan/code/github/AIGCDetectBenchmark-Cwyxx/train-cwyxx-GramNet.py", line 98, in <module>
    model.optimize_parameters()
  File "/data3/chenweiyan/code/github/AIGCDetectBenchmark-Cwyxx/networks/trainer.py", line 88, in optimize_parameters
    self.loss.backward()
  File "/data3/chenweiyan/miniconda3/envs/internvl/lib/python3.9/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/data3/chenweiyan/miniconda3/envs/internvl/lib/python3.9/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/data3/chenweiyan/miniconda3/envs/internvl/lib/python3.9/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
